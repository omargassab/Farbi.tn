{% extends "base.html" %}
{% block title %}Admin Order Details #{{ order.id }}{% endblock %}
{% block content %}
<div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
    <div class="flex justify-between items-start mb-6 border-b pb-4">
        <div> <h1 class="text-2xl font-bold text-gray-900">Order #{{ order.id }}</h1> <p class="text-sm text-gray-500 mt-1">Placed on: {{ order.order_date.strftime('%Y-%m-%d %H:%M:%S') }}</p> </div>
        <div> <span class="px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full {% if order.status == 'delivered' %} bg-green-100 text-green-800 {% elif order.status == 'cancelled' or order.status == 'failed_delivery' %} bg-red-100 text-red-800 {% elif order.status == 'out_for_delivery' %} bg-blue-100 text-blue-800 {% elif order.status == 'printing' or order.status == 'packaging' %} bg-yellow-100 text-yellow-800 {% else %} bg-gray-100 text-gray-800 {% endif %}"> {{ order.status.replace('_', ' ')|capitalize }} </span> </div>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div> <h2 class="text-xl font-semibold mb-3 text-gray-800">Customer Information</h2> <div class="space-y-3 text-sm"> <p><strong class="text-gray-600">Name:</strong> {{ order.customer_name }}</p> <p><strong class="text-gray-600">Phone:</strong> {{ order.customer_phone }}</p> <p><strong class="text-gray-600">Address:</strong><br>{{ order.customer_address|replace('\n', '<br>')|safe }}</p> {% if order.customer %} <p><strong class="text-gray-600">Registered User:</strong> <a href="{{ url_for('profile', username=order.customer.username) }}" class="text-indigo-600 hover:underline">{{ order.customer.username }} (#{{ order.user_id }})</a></p> {% else %} <p><strong class="text-gray-600">Registered User:</strong> Guest Order</p> {% endif %} </div> </div>
        <div> <h2 class="text-xl font-semibold mb-3 text-gray-800">Order Details</h2> <div class="space-y-3 text-sm"> <p><strong class="text-gray-600">Design:</strong> <a href="{{ url_for('design_detail', design_id=order.design_id) }}" class="text-indigo-600 hover:underline" target="_blank"> {{ order.design.title }} (#{{ order.design_id }}) </a> </p> <p><strong class="text-gray-600">Designer:</strong> <a href="{{ url_for('profile', username=order.design.designer.username) }}" class="text-indigo-600 hover:underline">{{ order.design.designer.username }}</a></p> <p><strong class="text-gray-600">Total Price:</strong> {{ "%.2f TND"|format(order.total_price) }}</p> <p><strong class="text-gray-600">Payment Method:</strong> Cash on Delivery</p> </div> <form action="{{ url_for('admin_update_order_status', order_id=order.id) }}" method="POST" class="mt-6 border-t pt-4"> <label for="status" class="block text-sm font-medium text-gray-700 mb-1">Update Order Status</label> <div class="flex items-center space-x-3"> <select id="status" name="status" class="flex-grow block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"> {% for status_option in statuses %} <option value="{{ status_option }}" {% if status_option == order.status %}selected{% endif %}> {{ status_option.replace('_', ' ')|capitalize }} </option> {% endfor %} </select> <button type="submit" class="px-4 py-2 rounded-lg text-sm font-medium bg-indigo-600 text-white hover:bg-indigo-700 transition duration-150 ease-in-out"> Update </button> </div> </form> </div>
    </div>
    <div class="mt-8 border-t pt-6"> <a href="{{ url_for('admin_orders') }}" class="text-indigo-600 hover:text-indigo-800 text-sm"> <i class="fas fa-arrow-left mr-1"></i> Back to All Orders </a> </div>
</div>
{% endblock %}